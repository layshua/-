numpy 的`ndarray`类用于表示矩阵和向量。 要在 numpy 中构造矩阵，我们在列表中列出矩阵的行， 并将该列表传递给 numpy 数组构造函数。

例如，构造与矩阵对应的 numpy 数组

![](<assets/1681625990415.png>)

我们会这样做

```
A = np.array([[1,-1,2],[3,2,0]])
```

向量只是具有单列的数组。 例如，构建向量

![](<assets/1681625990499.png>)

我们会这样做

```
v = np.array([[2],[1],[3]])
```

更方便的方法是转置相应的行向量。 例如，为了使上面的矢量，我们可以改为转置行向量

![](<assets/1681625990585.png>)

这个代码是

```
v = np.transpose(np.array([[2,1,3]]))
```

numpy 重载数组索引和切片符号以访问矩阵的各个部分。 例如，要打印矩阵 A 中的右下方条目，我们会这样做

要切出 A 矩阵中的第二列，我们会这样做

第一个切片选择 A 中的所有行，而第二个切片仅选择每行中的中间条目。

要进行矩阵乘法或矩阵向量乘法，我们使用 np.dot() 方法。

## [#](#用numpy求解方程组) 用 numpy 求解方程组

线性代数中比较常见的问题之一是求解矩阵向量方程。 这是一个例子。 我们寻找解决方程的向量 x

_A_ **x** = **b**

当

![](<assets/1681625990669.png>)

![](<assets/1681625990753.png>)

我们首先构建 A 和 b 的数组。

```
print(A[1,2])
```

为了解决这个系统

## [#](#应用-多元线性回归) 应用：多元线性回归

在多元回归问题中，我们寻找一种能够将输入数据点映射到结果值的函数。 每个数据点是_特征向量（x1，x2，...，xm）_，由两个或多个捕获输入的各种特征的数据值组成。为了表示所有输入数据以及输出值的向量，我们设置了输入矩阵 X 和输出向量 **y**：

![](<assets/1681625990838.png>)

![](<assets/1681625990923.png>)

在简单的最小二乘线性回归模型中，我们寻找向量**β**，使得乘积 Xβ最接近结果向量 **y**。

一旦我们构建了**β**向量，我们就可以使用它将输入数据映射到预测结果。 给定表单中的输入向量

![](<assets/1681625991007.png>)

我们可以计算预测结果值

![](<assets/1681625991093.png>)

计算β向量的公式是

**β** = (_X__T_ _X_)-1 _X__T_ **y**

在我们的下一个示例程序中，我将使用 numpy 构造适当的矩阵和向量并求解**β**向量。一旦我们解决了**β**，我们将使用它来预测我们最初从输入数据集中遗漏的一些测试数据点。

假设我们在 numpy 中构造了输入矩阵 X 和结果向量 **y**，下面的代码将计算**β**向量：

```
col = A[:,1:2]
```

最后一行使用`np.linalg.solve`计算**β**，因为等式是：

**β** = (_X__T_ _X_)-1 _X__T_ **y**

在数学上等价于方程组：

(_X__T_ _X_) **β** = _X__T_ **y**

我将用于此示例的数据集是 Windsor 房价数据集，其中包含有关安大略省温莎市区房屋销售的信息。 输入变量涵盖了可能对房价产生影响的一系列因素，例如批量大小，卧室数量以及各种设施的存在。[此处 open in new window](http://www2.lawrence.edu/fast/GREGGJ/Python/numpy/Housing.csv) 提供具有完整数据集的 CSV 文件。我从[这个网站 open in new window](https://vincentarelbundock.github.io/Rdatasets/datasets.html) 下载了数据集，该网站提供了大量涵盖大量主题的数据集。

这里现在是示例程序的源代码。

```
w = np.dot(A,v)
```

原始数据集包含 500 多个条目 为了测试线性回归模型所做预测的准确性，我们使用除最后 10 个数据条目之外的所有数据条目来构建回归模型并计算**β**。一旦我们构建了**β**向量，我们就用它来预测最后 10 个输入值，然后将预测的房价与数据集中的实际房价进行比较。

以下是该计划产生的产出：

```
A = np.array([[2,1,-2],[3,0,1],[1,1,-1]])
b = np.transpose(np.array([[-3,5,-2]]))
```

总体而言，预测并不是非常好，但是一些预测有点接近正确。从这些数据中做出更好的预测将成为机器学习冬季学期教程的主题。

## [#](#文章出处) 文章出处

由 NumPy 中文文档翻译，原作者为 [劳伦斯大学 open in new window](http://www.lawrence.edu/)，翻译至：[http://www2.lawrence.edu/fast/GREGGJ/Python/numpy/numpyLA.htmlopen in new window](http://www2.lawrence.edu/fast/GREGGJ/Python/numpy/numpyLA.html)。