# 一、Playerprefs
## 基本方法
prefs：控制台

- Playerprefs 是 unity 提供的可以用于**存储读取玩家数据的公共类**
- PlayerPrefs 的数据存储类似于**键值对**存储，一个键对应一个值
    - 提供了存储 3 种数据的方法：int float string
    - 键：string 类型
    - 值：int float string  对应 3 种 API
- 如果不同类型用同一键名进行存储，会覆盖数据

```cs file:存储数据
//直接调用set相关方法只会把数据存到内存里
//当游戏结束时 Unity会自动把数据存到硬盘中
PlayerPrefs.SetInt("myAge",18);  
PlayerPrefs.SetFloat("myHeight",1.75f);
PlayerPrefs.SetString("myName","张三");

//如果游戏不是正常结束的，而是崩溃，数据是不会存到硬盘中的
//可以调用save方法手动把数据存到硬盘中
PlayerPrefs.Save();
```

**注意运行时只要你 set 了对应键值对，即使你没有马上存储 save 在本地，也能够读取出信息**
```cs file:读取数据
int age = PlayerPrefs.GetInt("myAge",20); //可选第二参数，如果找不到myAge的值，就会返回第二个参数   
float height = PlayerPrefs.GetFloat("myHeight");
string name = PlayerPrefs.GetString("myName");
```

```cs file:判断数据是否存在
if(PlayerPrefs.HasKey("myAge"))
{
    print("myAge存在");
}
```

```cs file:删除数据
//删除单个数据
PlayerPrefs.DeleteKey("MyAge");
//删除所有存储的数据
PlayerPrefs.DeleteAll();
```

PlayerPrefs 是有局限性的它只能存 3 种类型的数据，如果你想要存储别的类型的数据只能降低精度或者上升精度来进行存储，当然也可采用下面的小 trick：

```cs file:trick存储bool类型
bool sex = true;
PlayerPrefs.SetInt( "sex", sex ? 1 : 0);
```

存储更复杂的 List<> 类型

```cs file:存储更复杂的List<>类型
//玩家信息类中存装备类，使用List存多个装备类
public class Player
{
    private string _name;
    public int _age;
    private int _atk;
    private int _def;

    //装备信息
    public List<Equipment> EquipmentsList;
    
    public void Save()
    {
        PlayerPrefs.SetString("name",_name);
        PlayerPrefs.SetInt("age",_age);
        PlayerPrefs.SetInt("atk",_atk);
        PlayerPrefs.SetInt("def",_def);
        
        //装备信息
        PlayerPrefs.SetInt("EquipmentsCount",EquipmentsList.Count);
        for(int i =0;i<EquipmentsList.Count;i++)
        {
            //存储每一个装备的id和数量
            PlayerPrefs.SetInt("EquipmentsID"+i,EquipmentsList[i]._id);
            PlayerPrefs.SetInt("EquipmentsCount"+i,EquipmentsList[i]._count);
        }
        
    }

    public void Load()
    {
        _name = PlayerPrefs.GetString("name", "test");
        _age = PlayerPrefs.GetInt("age", 18);
        _atk = PlayerPrefs.GetInt("atk", 100);
        _def = PlayerPrefs.GetInt("def", 1000);
        
        //装备信息
        int num = PlayerPrefs.GetInt("EquipmentsCount",0);
        EquipmentsList = new List<Equipment>();
        for(int i =0;i < num;i++)
        {
            Equipment equipment = new Equipment();
            equipment._id = PlayerPrefs.GetInt("EquipmentsID"+i,0);
            equipment._count = PlayerPrefs.GetInt("EquipmentsCount"+i,0);
            EquipmentsList.Add(equipment);
        }
    }
}

public class Equipment
{
    public int _id;
    public int _count;
}


public class NewBehaviourScript : MonoBehaviour
{
    
    // Start is called before the first frame update
    void Start()
    {
        Player player = new Player();
        player.Load();
        
        print("装备列表数量："+ player.EquipmentsList.Count);
        
        for (int i = 0; i < player.EquipmentsList.Count; i++)
        {
            print("道具ID：" + player.EquipmentsList[i]._id);
            print("道具数量：" + player.EquipmentsList[i]._count);
        }
        
        
        Equipment equipment1 = new Equipment();
        equipment1._id = 1;
        equipment1._count = 1;
        
        Equipment equipment2 = new Equipment();
        equipment2._id = 2;
        equipment2._count = 2;
        
        player.EquipmentsList.Add(equipment1);
        player.EquipmentsList.Add(equipment2);
        
        player.Save();
        
        print("装备列表数量："+ player.EquipmentsList.Count);
        for (int i = 0; i < player.EquipmentsList.Count; i++)
        {
            print("道具ID：" + player.EquipmentsList[i]._id);
            print("道具数量：" + player.EquipmentsList[i]._count);
        }
        PlayerPrefs.DeleteAll();
    }
}
```

## 存储位置
