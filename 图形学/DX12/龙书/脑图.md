# 5DX12 初始化
test
```markmap
---
markmap:
  height: 603
---

# DX12 初始化

## Debug

## DXGIFactory

## CommandAllocator
- Reset
## GraphicsCommandList


```


# DX12 管线梳理

```markmap
---
markmap:
  colorFreezeLevel: 0
  height: 913
---

# DX12管线梳理

## 整条线总结

### Pre Init

-   命令解析
    
-   日志系统
    

### Init

-   InitDirect3D
    
    -   D3D12GetDebugInterface
        
    -   CreateDXGIFactory1
        
    -   D3D12CreateDevice
        
    -   CreateFence
        
    -   CreateCommandQueue
        
    -   CreateCommandAllocator
        
    -   CreateCommandList
        
    -   CheckFeatureSupport
        
    -   CreateSwapChain
        
    -   CreateDescriptorHeap
        
        -   RTVHeap
            
        -   DSVHeap
            
-   PostInitDirect3D
    
    -   WaitGPUCommandQueueComplete
        
    -   CommandAllocator
        
        -   Reset
            
    -   SwapChainBuffer
        
        -   Reset
            
    -   ResizeBuffers
        
        -   自适应屏幕变大
            
    -   CreateRenderTargetView
        
        -   SwapChainBuffer
            
    -   CreateCommittedResource
        
    -   CreateDepthStencilView
        
    -   ExecuteCommandLists
        
    -   ViewprotInfo
        

### Post Init

-   模型前期数据注册
    
-   根签名
    
-   Shader输入布局
    
-   构建模型数据
    
    -   将数据存储在上传堆上
        
-   构建堆
    
-   构建缓冲区
    
    -   描述模型状态
        
-   构建摄像机常量缓冲区
    
-   属性和参数绑定PSO
    

### Tick

-   自由主题
    
-   UpdateCalculations
    
    -   视口状态和位置
        
    -   模型状态和位置
        
-   Pre Draw
    
    -   Reset PSO
        
-   Tick
    
    -   绑定矩形框
        
    -   清除画布
        
    -   清除深度模板缓冲区
        
    -   输出的合并阶段
        
-   Draw
    
    -   SetDescriptorHeaps
        
        -   CBVHeap
            
    -   SetGraphicsRootSignature
        
        -   RootSignature
            
    -   MeshDraw
        
        -   DrawViewport
            
            -   根据堆内存偏移绑定到CommandList
                
        -   DrawMesh
            
            -   根据堆内存偏移绑定到CommandList
                
    -   DirectXPipelineState
        
        -   CaptureKeyboardKeys
            
-   Post Draw
    

## 常量缓冲区

### 常量缓冲区

-   ConstantBuffer
    
    -   b0-bN
        

### 着色器资源

-   ShaderResourceViews
    
    -   t0-tN
        

### 无序访问

-   UnorderedAccessViews
    
    -   u0-uN
        

### 纹理采样器

-   Texture Samplers
    
    -   s0-sN
        

# DX12 基础结构

## 初始化

-   DXAPI初始化
    
-   绑定渲染管线
    
    -   PSO
        

## 渲染

-   模型和视口世界空间状态更新
    
-   绑定命令列表
    
    -   提交
        

# SLB

#InitWindows

```


# DX12 渲染流程
```markmap 
---
markmap:
  colorFreezeLevel: 0
  height: 616
---

# DX12 渲染流程

## Init

### InitDirect3D

-   BUFF
    
    -   SwapChainBuffer
        
        -   ID3D12Resource
            
    -   DepthStencilBuffer
        
        -   ID3D12Resource
            
-   配置
    
    -   视口配置
        
        -   ViewprotInfo
            
        -   ViewprotRect
            
    -   buff配置
        
        -   BackBufferFormat
            
        -   DepthStencilFormat
            
-   Deap
    
    -   DSVHeap
        
        -   深度模板视图
            
    -   RTVHeap
        
        -   渲染目标视图
            
-   初始化
    
    -   Debug
        
        -   D3D12Debug
            
    -   结构
        
        -   Fence
            
        -   D3dDevice
            
            -   设置多重采样
                
        -   DXGIFactory
            
    -   队列
        
        -   CommandQueue
            
            -   D3D12_COMMAND_QUEUE_DESC QueueDesc
                
        -   CommandAllocator
            
        -   GraphicsCommandList
            
    -   SwapChain
        
        -   交换链描述
            

### PostInitDirect3D

-   reset
    
    -   1.CommandAllocator
        
    -   2.SwapChainBuffer
        
    -   3.DepthStencilBuffer
        
-   3.创建RTV
    
    -   前buff
        
    -   后buff
        
-   4.通过描述创建DSV
    
-   5.设置DSV资源 状态 COMMON
    
-   6.结束命令录入
    
-   7.ExecuteCommandLists
    

### PostInit

-   1.reset
    
    -   CommandAllocator
        
-   2对象生成
    
-   3BuildMesh
    
    -   BuildRootSignature
        
        -   DescriptorRangeObjCBV
            
        -   DescriptorRangeViewportCBV
            
        -   DescriptorRangeMaterialCBV
            
        -   DescriptorRangeLightCBV
            
    -   VertexShader
        
    -   PixelShader
        
    -   InputElementDesc
        
    -   常量缓冲区
        
        -   Mesh
            
        -   Viewport
            
        -   mat
            
        -   light
            
    -   PSO构建
        
-   1.Close
    
    -   .结束命令录入
        
-   7.ExecuteCommandLists
    

## Tick

### reset

-   1.CommandAllocator
    
-   2.SwapChainBuffer
    
-   3.DepthStencilBuffer
    

### Mesh

-   4.Draw
    
    -   a.设置POS
        

### 5.资源状态设置

-   CurrentSwapBuff
    
    -   将P->RTV
        

### 6.RSSetViewports

-   ViewprotInfo
    

### 7.RSSetScissorRects

-   ViewprotRect
    

### 8.ClearRenderTargetView

-   GetCurrentSwapBufferView
    
-   GetCurrentDepthStencilView
    

### 9.OMSetRenderTargets

-   将RTV->P
    

### 10.Mesh

-   Draw
    
    -   a.CBV常量缓冲区描述符 设置
        
    -   b.RootSignature
        
    -   c.几何渲染
        

### 11.Close

-   .结束命令录入
    

### 12.交换buff缓冲区

```
