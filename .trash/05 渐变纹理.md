![[f0ce8c8e5cab0591f8bf3cde185055a3_MD5.webp]]

根据一张渐变纹理实现 ramp

![[1bd344f8a3379cbb43fe35a05105a548_MD5.webp]]

渐变纹理的映射非常简单，核心思想是在对贴图进行采样时，不使用的常规的模型的 uv 采样，而是对 Dot（N,L) 进行采样，由于我们使用的 ramp 图是水平渐变的，故采样的 u 轴即为 Dot（N,L)，而 v 轴为常数，一般取 0.5，即 ramp 图的中间水平线。

![[ffba4d59fb0bec7bf759dfe3a5634f08_MD5.webp]]

采样

为了使颜色渐变更好看，把 Dot（N,L) 兰伯特转成半兰伯特，作为 uv 贴图的水平轴 u 轴，垂直轴 v 轴取定值 0.5 即可，取 0 或者 1 则可能会出现因贴图的边缘采样偏差加上贴图的格式（repeat 或者 clamp）导致的误差问题。

代码非常简单，以下为 shader 源码
```c
Shader "URP/RAMP"

{

    Properties

    {

        _MainTex("RAMP",2D)="White"{}

        _BaseColor("BaseColor",Color)=(1,1,1,1)

    }

    SubShader

    {

        Tags{

        "RenderPipeline"="UniversalRenderPipeline"

        "RenderType"="Opaque"

        }

        HLSLINCLUDE

        #include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Lighting.hlsl"

        #include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl"

        CBUFFER_START(UnityPerMaterial)

        float4 _MainTex_ST;

        half4 _BaseColor;

        CBUFFER_END

        sampler2D _MainTex;

         struct a2v

         {

             float4 positionOS:POSITION;

             float3 normalOS:NORMAL;

         };

         struct v2f

         {

             float4 positionCS:SV_POSITION;

             float3 normalWS:NORMAL;

         };

        ENDHLSL

        pass

        {

        Tags{

        "LightMode"="UniversalForward"

        }

            HLSLPROGRAM

            #pragma vertex VERT

            #pragma fragment FRAG

            v2f VERT(a2v i)

            {

                v2f o;

                o.positionCS=TransformObjectToHClip(i.positionOS.xyz);

                o.normalWS=normalize(TransformObjectToWorldNormal(i.normalOS));

                return o;

            }

            half4 FRAG(v2f i):SV_TARGET

            {

            real3 lighdir=normalize(GetMainLight().direction);

                float dott=dot(i.normalWS,lighdir)*0.5+0.5;

                half4 tex=tex2D(_MainTex,float2(dott,0.5))*_BaseColor;

                return tex;

            }

            ENDHLSL

        }

    }

}
```