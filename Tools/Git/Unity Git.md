# 官方支持
https://unity.github.com/
# Git 最佳实践

在说 Unity 与 Git 之前，我们先来看一下一些 Git 的通用最佳实践是什么。

**提交相关的变化**  
一次提交应该是相关联的修改。如果是修改了两个不同的 BUG，应该分两次提交。小的 commit 可以让你的协作者更容易理解，并且一旦出现问题可以很容易回退版本。

**经常提交**  
经常提交可以确保你的提交足够小，并且提交相关联的变化，还可以减少代码冲突。

**不要提交没做完的工作**  
这不是说你要完成一个完整的功能才能提交，而是要将功能拆分，然后经常提交。不能让协作者拿到你的代码后出现编译错误、系统不能运行等情况。

**提交之前应该测试**  
提交之前应该进行测试，不要让你的代码影响别人的工作。

**重视提交 Message**  
提交 Message 应该清楚地写明和本次提交相关的内容（不超过 25 个字）。如果需要填写更详细的内容，空一行后写下具体的提交信息。

很多童鞋经常着急提交，Message 经常写一些无关的字符来满足提交的需求，这种坏习惯总有一天会害了你自己。

**版本控制不是备份系统**  
版本控制虽说可以备份你的项目，但是不要把 Git 当作一个备份的工具。不要将你本地的乱七八糟的文件都使用 Git 进行备份。记住 Git 是用来进行版本管理的，是用来跟踪管理这些文件的变化。

**多用分支**  
分支是 Git 最强大的功能之一。你应该多使用分支来拓宽开发的工作流：新功能、BUG 修复、新创意等等。

**团队内就工作流程达成一致**  
Git 给了你很多选择，比如划分几个分支，什么时候开辟新的分支，merge 还是 rebase 等等。这些都应该基于你的项目进行选择，并且在团队中达成一致后严格执行。

## Unity 与 Git

在理解并执行上述的 Git 最佳实践之后，我们再来看 Git 在 Unity 中有哪些特殊的地方。

使用 Git 管理 Unity 项目一般流程如下：

1.  在托管平台（之前介绍过多个国内外的托管平台，也可以自建）上创建 Git 项目
2.  在本地 Clone 创建的项目
3.  创建 Unity 工程到该版本库目录中
4.  设置 Unity 工程的一些配置
5.  设置 gitignore 文件
6.  commit 和 push，在 Git 的保驾护航下开始愉快地开发 Unity 项目！

## 配置 Unity 的文件属性

为什么需要配置 Unity 的文件属性呢？这也是基于 Git 的一些原则：

*   Git 无法合并二进制文件，尽量避免会发生变化的文件使用二进制格式
*   一个 Git 版本库应该是一个完整的项目，需要包含项目可运行调试的所有代码、配置文件和资源。

通常 Unity 中需要设置的内容有以下几项：

## 设置 Asset Serialization 为 Force Text

上面提到了，Git 无法处理二进制文件的合并，只能处理文本文件的合并。如果二进制文件出现了冲突，那只能选择一个文件保留，无法将两个文件进行合并。对于 Unity 中的文件，我们需要尽量避免这种情况。

默认情况下，Unity 的资产序列化模式是 Mixed。

![[fa326e65f3367438cde4a7678cc6e554_MD5.jpg]]

资产序列化有三种模式：

*   **Mixed**：混合模式，保持资产原来的序列化的模式，新的资产使用二进制的方式序列化。
*   **Force Binary**：强制二进制，如果不需要合并，可以使用二进制模式节省存储空间。如果一个项目只有你一个人开发，不会出现合并的情况，可以使用这个模式。
*   **Force Text**：强制文本模式。**只要你的项目有多个人一起开发，就需要将资产序列化的模式设置为这个模式。**

## 设置 Version Control 为 Meta Files

Unity 的 Editor 设置中，Version Control 的 Mode 需要设置为 Meta Files。  
对于使用新版本 Unity 的童鞋，一般不需要进行额外设置，默认为 Visible Meta Files，只需要检查一下即可。

![[a0fe8c49e75de2c68b5da0cd54530a20_MD5.jpg]]

一共有 4 种模式：

*   Hidden Meta Files：隐藏的 Meta 文件，即该文件的属性是隐藏的，在系统中如果不查看隐藏文件这些文件是看不到的。如果你不想看到这些 Meta Files，你可以设置为该选项。
*   Visible Meta Files：可见的 Meta 文件。
*   Perforce：Unity 内置的一种版本控制工具。
*   PlasticSCM：Unity 内置的一种版本控制工具。

**什么是 Meta 文件？**  
Meta 文件在 Unity 中用来跟踪资产文件的一些信息，比如元数据、资产之间的关联等，是非常重要的一种数据，不能删除。删除后可能会丢失文件之间的关联信息。

![[e3f84da73479a45604fd4bef91214edc_MD5.jpg]]

在较旧版本的 Unity 中，还有一个 Off 的选项，选中这个选项时 Unity 不会生成 meta 文件，资产文件之间的关联都存储在临时文件中，使用版本控制管理时会造成关联丢失。

**使用 Git 时，一定要选中 Meta Files 这个选项。**

## 设置好 Gitignore

提前设置好 gitignore 文件可以防止将临时文件及不需要版本控制的文件提交到版本库中。

对于 Unity 工程自动生成的文件夹，只有下面几个目录是需要加入版本控制的：

*   Assets
*   ProjectSettings
*   Packages

其他 Unity 自动生成的文件和文件加不需要加入版本控制，但是需要注意将你自己创建的文件或者文件夹加入版本控制。

Github 中的 Unity 项目的 gitignore 文件是最好的初始模板：  
[https://github.com/github/gitignore/blob/master/Unity.gitignore](https://github.com/github/gitignore/blob/master/Unity.gitignore)

```
# This .gitignore file should be placed at the root of your Unity project directory
#
# Get latest from https://github.com/github/gitignore/blob/main/Unity.gitignore
#
/[Ll]ibrary/
/[Tt]emp/
/[Oo]bj/
/[Bb]uild/
/[Bb]uilds/
/[Ll]ogs/
/[Uu]ser[Ss]ettings/

# MemoryCaptures can get excessive in size.
# They also could contain extremely sensitive data
/[Mm]emoryCaptures/

# Recordings can get excessive in size
/[Rr]ecordings/

# Uncomment this line if you wish to ignore the asset store tools plugin
# /[Aa]ssets/AssetStoreTools*

# Autogenerated Jetbrains Rider plugin
/[Aa]ssets/Plugins/Editor/JetBrains*

# Visual Studio cache directory
.vs/

# Gradle cache directory
.gradle/

# Autogenerated VS/MD/Consulo solution and project files
ExportedObj/
.consulo/
*.csproj
*.unityproj
*.sln
*.suo
*.tmp
*.user
*.userprefs
*.pidb
*.booproj
*.svd
*.pdb
*.mdb
*.opendb
*.VC.db

# Unity3D generated meta files
*.pidb.meta
*.pdb.meta
*.mdb.meta

# Unity3D generated file on crash reports
sysinfo.txt

# Builds
*.apk
*.aab
*.unitypackage
*.app

# Crashlytics generated file
crashlytics-build.properties

# Packed Addressables
/[Aa]ssets/[Aa]ddressable[Aa]ssets[Dd]ata/*/*.bin*

# Temporary auto-generated Android Assets
/[Aa]ssets/[Ss]treamingAssets/aa.meta
/[Aa]ssets/[Ss]treamingAssets/aa/*
```

**注意**：gitignore 文件可能随着项目的开发过程而发生变化，要注意根据项目的实际情况进行维护。

## 不要将大文件放入 git 管理

项目中可能有很大的文件比如参考资料、视频、发布的程序等。这些尺寸很大、几乎不会变化的文件建议使用网盘等方式在团队之间共享，不要放到 Git 版本库中。

## 尽量不将美术中间文件放到工程中

在 Unity 项目的开发过程中经常会有比较大的文件：比如贴图的原始 PSD 文件，模型的原始 max 文件等。这些文件一般情况会很大，尽量不要放到 Git 中进行管理。在版本库中存储的文件尽量是最终的图片或 fbx 格式的文件。

**注意**：这条建议也并非绝对，有时候使用 psd 或 max 文件可能更合理，需要自行判断。

## 总结

在 Unity 项目中使用 Git 进行管理，需要注意以下流程：

1.  在托管平台上创建 Git 项目
2.  在本地 Clone 创建的项目
3.  创建 Unity 工程到该版本库目录中
4.  设置 Unity 工程的一些配置（Asset Serialization 设置为 Force Text）
5.  设置 gitignore 文件（参考 Github 提供的 gitignore 文件）
6.  commit 和 push，在 Git 的保驾护航下开始愉快地开发 Unity 项目！

