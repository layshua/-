
## GameMode 和GameState
两个主要类负责处理进行中游戏的相关信息：**Game Mode** 和 **Game State**。

即使最开放的游戏也拥有基础规则，而这些规则构成了 **Game Mode**。在最基础的层面上，这些规则包括：
- 出现的玩家和观众数量，以及允许的玩家和观众最大数量。
- 玩家进入游戏的方式，可包含选择生成地点和其他生成/重生成行为的规则。
- 游戏是否可以暂停，以及如何处理游戏暂停。
- 关卡之间的过渡，包括游戏是否以动画模式开场。
    

基于规则的事件在游戏中发生，需要进行追踪并和所有玩家共享时，信息将通过 **Game State** 进行存储和同步。这些信息包括：
- 游戏已运行的时间（包括本地玩家加入前的运行时间）。
- 每个个体玩家加入游戏的时间和玩家的当前状态。
- 当前 Game Mode 的基类。
- 游戏是否已开始。

### GameMode
**游戏模式 GameMode**
Game Modes 的任务是定义和实现规则。Game Modes 当前常用的基类有两个。
4.14 版本中加入了 `AGameModeBase`，这是所有 Game Mode 的基类，是经典的 `AGameMode` 简化版本。`AGameMode` 是 4.14 版本之前的基类，仍然保留，功能如旧，但现在是 `AGameModeBase` 的子类。
由于其比赛状态概念的实现，`AGameMode` 更适用于标准游戏类型（如多人射击游戏）。
`AGameModeBase` 简洁高效，是新代码项目中包含的全新默认游戏模式。

**一款游戏可拥有任意数量的 Game Mode**，因此也可拥有任意数量的 `AGameModeBase` 类子类；然而，**给定时间上只能使用一个 Game Mode**。每次关卡进行游戏实例化时 Game Mode Actor 将通过 `UGameEngine::LoadMap()` 函数进行实例化。

**Game Mode 不会复制到加入多人游戏的远程客户端；它只存在于服务器上**，因此本地客户端可看到之前使用过的留存 Game Mode 类（或蓝图）；但无法访问实际的实例并检查其变量，确定游戏进程中已发生哪些变化。
如玩家确实需要更新与当前 Game Mode 相关的信息，可将信息保存在一个 `AGameStateBase` Actor 上，轻松保持同步。`AGameStateBase` Actor 随 Game Mode 而创建，之后被复制到所有远程客户端。

默认设置：
![[Pasted image 20230115223623.png]]
在关卡编辑器的 WorldSetting 中重载，实际运行以重载的 GameMode 为准：
WorldSetting 并不是设置 World 的属性（不要混肴），是针对 Level 的设置。仅代表当前一个关卡，并不是所有关卡。
![[Pasted image 20230115223741.png|300]]

### GameState
**游戏状态 GameState，主要用于联机游戏**

**Game State** 负责启用客户端监控游戏状态。从概念上而言，Game State 应该管理所有已连接客户端已知的信息（特定于 Game Mode 但不特定于任何个体玩家）。它能够追踪游戏层面的属性，如已连接玩家的列表、夺旗游戏中的团队得分、开放世界游戏中已完成的任务，等等。

Game State 并非追踪玩家特有内容（如夺旗比赛中特定玩家为团队获得的分数）的最佳之处，因为它们由 **Player State** 更清晰地处理。**整体而言，GameState 应该追踪游戏进程中变化的属性。这些属性与所有人皆相关，且所有人可见。** 
**Game mode 只存在于服务器上，而 Game State 存在于服务器上且会被复制到所有客户端，保持所有已连接机器的游戏进程更新。**

## PlayerState
**玩家状态 PlayerState，负责角色数据（攻击力，血量等），主要用于联机游戏**

玩家状态类用于记录特定玩家的信息，这些信息在多人游戏中需要与其他客户端共享。
玩家控制器仅存在于客户端上，而玩家状态会从服务器复制到所有客户端。
要使用基于玩家状态类的新蓝图，必须在游戏模式的玩家状态类参数中设置。

